free d:channel.
free t:bitstring [private].

type lfz.
type tubnq.
fun tfod(bitstring,lfz):bitstring.
reduc forall y:bitstring,z:lfz; tefd(tfod(y,z),z) = y.

event VBdujpo(tubnq,bitstring).

axiom tu:tubnq, y:bitstring, z:bitstring;
  event(VBdujpo(tu,y)) && event(VBdujpo(tu,z)) ==> y = z.

query attacker(t).

process
  new l:lfz; out(d, tfod(tfod(t,l),l));
  in(d, y:bitstring);
  new tu[]:tubnq;
  event VBdujpo(tu,y);
  out(d, tefd(y,l))
