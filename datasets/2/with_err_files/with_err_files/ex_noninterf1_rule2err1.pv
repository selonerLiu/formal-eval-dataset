free c: channel.


type key.
reduc forall x: bitstring, y: key; sdec(senc(x,y),y) = x.


free k:key [private].


free secret_msg: bitstring [private].
noninterf secret_msg.

process (!out(c, senc(secret_msg, k))) | 
	(!in(c, x:bitstring); let s = sdec(x, k) in 0)
