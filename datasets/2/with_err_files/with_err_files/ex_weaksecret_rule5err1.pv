free d: channel.

type tlfz.
type qlfz.

fun ql(tlfz): qlfz.
fun bfod(bitstring, qlfz): bitstring.

reduc forall n: bitstring, l: tlfz; befd(bfod(n,ql(l)),l) = n.

free w: bitstring [private].
weaksecret w.

let W(qlB:qlfz) = out(d, bfod(w, qlB)).

let B(tlB:tlfz) = in(d,y:bitstring); let w' = befd(y, tlB) in 0.

process 
	new tlB: tlfz;
	let qlB = ql(tlB) in
	out(d, qlB);
	! (W(qlB) | B(tlB))
