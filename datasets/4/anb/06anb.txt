Simpler Yahalom protocol
The security goal is to authenticate the identity of A to B and vice versa, and to establish a shared secret key between A and B.
The flow of the protocol is as follows:
A -> B: A, N_A
B -> S: B, N_B, { A, N_A }_Kbs
S -> A: N_B, { B, K_ab, N_A }_Kas, { A, K_ab, N_B }_Kbs
A -> B: { A, K_ab, N_B }_Kbs, { N_B }_Kab