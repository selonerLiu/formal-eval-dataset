Augmented EKE, Bellovin, Merritt, Section 3. A and B are two parties that want to communicate securely.
The security goal is that, under the premise that both parties only share a weak password, it is possible to achieve secure mutual authentication and negotiate a high-strength session key.
The flow of the protocol is as follows:
1. A->B: {hostA, exp(g, RA)}h(P)
2. B->A: ({exp(g, RB)}h(P), {challengeB}K)
3. A->B: {challengeA, challengeB}K
4. B->A: {challengeA}K
5. A->B: {F(P, K)}K